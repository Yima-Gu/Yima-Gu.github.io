---
syntax_converted: true
---

# 第6章：无线与移动网络 (Wireless and Mobile Networks)

## 6.1 引言 (Introduction)

### 背景
* **趋势：** 无线（移动）电话用户数量已超过有线电话用户。
* **设备：** 笔记本电脑、掌上电脑、PDA、互联网手机等承诺随时随地的互联网接入。
* **两大挑战：**
    1.  **无线 (Wireless)：** 通过无线链路进行的通信。
    2.  **移动性 (Mobility)：** 处理移动用户改变网络接入点的情况。

### 无线网络要素 (Elements of a wireless network)
1.  **无线主机 (Wireless hosts)：**
    * 终端设备（如笔记本、手机、IoT设备）。
    * 运行应用程序。
    * 可以是静止的或移动的（无线不等于移动）。
2.  **基站 (Base station)：**
    * 通常连接到有线网络。
    * **中继 (Relay)：** 负责在其覆盖区域内的有线网络和无线主机之间发送数据包。
    * 例如：蜂窝塔 (Cell towers)、802.11 接入点 (Access Points, AP)。
3.  **无线链路 (Wireless link)：**
    * 连接移动设备到基站，或作为骨干链路。
    * 使用**多路访问协议 (Multiple Access Protocol)** 协调链路访问。
    * 具有不同的数据传输速率和传输距离。
4.  **网络基础设施 (Network infrastructure)：**
    * **基础设施模式 (Infrastructure mode)：** 基站将移动设备连接到有线网络。涉及**切换 (Handoff)**（移动设备改变接入的基站）。
    * **自组网模式 (Ad hoc mode)：** 无基站。节点只能向覆盖范围内的其他节点发送数据。节点自组织成网络并在彼此间路由。

---

## 6.2 无线链路与特性 (Wireless links, characteristics)

### 与有线链路的区别
1.  **信号强度衰减 (Decreased signal strength)：** 无线电信号在穿过物质时会衰减（路径损耗 Path loss）。
2.  **干扰 (Interference)：** 标准化无线频率（如 2.4 GHz）被其他设备（如微波炉、电话、电机）共享，导致干扰。
3.  **多径传播 (Multipath propagation)：** 无线电信号经物体反射，导致信号在略微不同的时间到达目的地。

### 信噪比 (SNR) 与误码率 (BER)
* **SNR (Signal-to-Noise Ratio)：** 信噪比。SNR 越大，越容易从噪声中提取信号。
* **权衡 (Tradeoffs)：**
    * 增加功率 -> 增加 SNR -> 降低 BER。
    * 给定 SNR，选择满足 BER 要求的物理层技术以获得最高吞吐量。
    * **动态适应：** 随着移动导致 SNR 变化，动态调整物理层（调制技术、速率）。

### 隐藏终端问题 (Hidden Terminal Problem)
* A 和 C 都在 B 的覆盖范围内，但 A 和 C 互相听不到对方。
* A 和 C 可能同时向 B 发送数据，导致在 B 处发生**干扰 (Interference)**，但 A 和 C 却无法检测到冲突。

### <mark>CDMA (码分多址) </mark>

CDMA 将“编码空间”作为一个全新的维度，不同于 TDMA（时间）和 FDMA（频率）。

1.  **核心概念：码片序列 (Chipping Sequence)**
    * 每个用户被分配一个**唯一**的“码”（Code）。
    * 所有用户在**同一时间**使用**同一频率**进行传输。
    * 依靠各自独特的码片序列来区分数据。

2.  **关键特性：正交性 (Orthogonality)**
    * 为了最小化干扰，分配给不同用户的码必须是**正交**的。
    * **定义：** 两个不同码向量的**内积 (Inner-product / Dot product)** 为 0。
    * 公式：如果用户 A 的码是向量 $a$，用户 B 的码是向量 $b$，则 $a \cdot b = 0$。

3.  **编码与发送 (Encode)**
    * 发送的信号 = (原始数据位) $\times$ (码片序列)。
    * 假设数据位 $d$ 为 $1$ 或 $-1$。
    * 用户 A 发送信号 $Z_a = d_{A} \cdot a$。
    * **叠加 (Superposition)：** 在无线信道中，多个用户的信号会线性叠加。总信号 $S = (d_A \cdot a) + (d_B \cdot b)$。

4.  **解码与抗干扰 (Decode)**
    * 接收方如何从叠加信号 $S$ 中提取用户 A 的数据？
    * **机制：** 接收方使用用户 A 的码片序列 $a$ 与接收到的总信号 $S$ 进行**内积**运算。
    * **数学推导：**
      $$S \cdot a = (d_A \cdot a + d_B \cdot b) \cdot a$$
      展开得到：$= d_A(a \cdot a) + d_B(b \cdot a)$
    * **消除干扰：** 由于正交性，$b \cdot a = 0$，因此用户 B 的信号项消失。
    * **结果：** 剩下 $d_A(a \cdot a)$。若码长为 $M$（即 $a \cdot a = M$），除以 $M$ 即可完美还原原始数据 $d_A$。

5.  **香农定理 (Shannon Theory)**
    * 信道容量 $C = W \log(1 + P/N)$。CDMA 利用宽带（W）来提升容量。

> [!NOTE] 拓展知识：CDMA 的数学基础与 Hadamard 矩阵
>
> **1. CDMA 的特殊约束**
> 在通信工程中，为了便于数字电路实现，码向量的分量通常被限制为 **$+1$ 或 $-1$**（而非任意实数）。
>
> **2. 向量模长**
> 在这种限制下（分量仅为 $\pm 1$），一个 $n$ 维向量 $v=(c_1, c_2, ..., c_n)$ 的模长平方恒等于 $n$。
> * **推导**：因为对于任意 $i$，都有 $c_i^2 = 1$，故 $\sum_{i=1}^{n} c_i^2 = n$。
> * **结论**：即模长为 $\sqrt{n}$。
>
> **3. Hadamard 矩阵**
> 这种由 $+1$ 和 $-1$ 组成且行向量相互正交的矩阵被称为 **Hadamard 矩阵**。
> * **存在条件**：$n$ 必须是 1、2 或者是 4 的倍数。

---

## 6.3 IEEE 802.11 无线局域网 ("Wi-Fi")

### 802.11 标准演进
* **802.11b:** 2.4-5 GHz, 最高 11 Mbps, DSSS (直接序列扩频)。
* **802.11a:** 5-6 GHz, 最高 54 Mbps。
* **802.11g:** 2.4-5 GHz, 最高 54 Mbps。
* **802.11n:** 2.4-5 GHz, 最高 450 Mbps, 多天线 (MIMO)。
* **802.11ac:** 5 GHz, 最高 1.3 Gbps (Wave 1) / 3.4 Gbps (Wave 2)。
* **802.11ax (Wi-Fi 6):** 更高的数据率 (1024 QAM)、更低延迟、OFDMA、更好的 IoT 覆盖。
* **共性：** 都使用 **CSMA/CA** 进行多路访问；都有基站（基础设施）和 Ad-hoc 模式。

### 架构 (Architecture)
* **基本服务集 (BSS, Basic Service Set)：** 包含无线主机和基站（接入点 AP）。
* **信道 (Channels)：** 频谱被划分为多个信道。AP 管理员选择频率。相邻 AP 可能产生干扰。
* **关联 (Association)：**
    * **被动扫描 (Passive Scanning)：** 主机监听 AP 发送的**信标帧 (Beacon frames)**。
    * **主动扫描 (Active Scanning)：** 主机广播**探测请求 (Probe Request)**，AP 回复探测响应。
    * 关联后通常运行 DHCP 获取 IP 地址。

### AP 与 SSID

1.  **接入点 (AP - Access Point)**
    * **定义：** 在基础设施模式下，AP 是无线网络中的**基站 (Base Station)** 。
    * **功能：** 它是无线主机与有线网络之间的桥梁。所有的无线主机都必须先与 AP **关联 (Associate)** 才能进行通信。
    * **角色：** 一个基本服务集 (BSS) 通常包含一个 AP 和若干无线主机。

2.  **服务集标识符 (SSID - Service Set Identifier)**
    * **定义：** 俗称“网络名称”（例如 "Tsinghua-Secure" 或 "Home-WiFi"）。它是 AP 分配给其 BSS（或扩展服务集）的一串字符标识。
    * **作用：** 帮助主机识别和区分不同的无线网络。
    * **工作机制：** AP 会定期广播**信标帧 (Beacon frames)**，其中包含了 AP 的 **SSID** 和 MAC 地址 。
    * **扫描：** 当你的设备“搜索 Wi-Fi”时，实际上是在扫描并列出监听到的信标帧中的 SSID，供你选择关联。
### <mark>MAC 协议：CSMA/CA (载波侦听多路访问/冲突避免)</mark>
* **为什么不用 CSMA/CD (冲突检测)？**
    * 无线信号衰减导致发送端很难在传输时检测到冲突（信号太弱）。发送方自己的发送信号强度远远大于它能接收到的来自远处的信号强度。
    * 存在隐藏终端问题，无法检测所有冲突。A 和 C 都在 B 的覆盖范围内，但 A 和 C 互不可见（互为隐藏终端）。
* **CSMA/CA 机制：**
    1.  **发送方：**
        * 如果侦听到信道空闲（持续 DIFS *Distributed Inter-Frame Space* 时间），则发送**整个帧**。
        * 如果信道忙，则开始**随机退避 (Random backoff)**。信道空闲时倒计时，忙时暂停。计时器到期后发送。如果没有收到 ACK，增加退避区间并重试。
    2.  **接收方：**
        * 如果正确接收帧，在 SIFS *Short Inter-Frame Space* 时间后返回 **ACK**。
        * **为什么必须有 ACK？** 因为发送方无法自己检测冲突（如上所述），所以“没有收到 ACK”是发送方判断发生冲突或丢包的唯一依据。
* **冲突避免 (RTS-CTS 交换)：**
    * **思想：** **小包换大包** ：长的数据帧一旦发生冲突，会浪费大量的信道时间。RTS/CTS 机制允许发送方先用很小的控制包“预约”信道。如果小包冲突了，损失很小；如果预约成功，大包就不会冲突 。
    * **RTS (Request-to-Send)：** 发送方先发送小的 RTS 包给基站。
    * **CTS (Clear-to-Send)：** 基站广播 CTS 响应。所有节点（包括隐藏终端）都能听到 CTS。
    * **结果：** 发送方发送数据，其他节点推迟发送。

### 802.11 帧结构
* **地址字段：**
    * **Address 1:** 接收端的 MAC 地址。
    * **Address 2:** 发送端的 MAC 地址。
    * **Address 3:** 连接 AP 的路由器接口的 MAC 地址。
    * **Address 4:** 仅用于 Ad hoc 模式。
* **其他字段：** 帧控制、持续时间 (Duration, 用于预约时间)、序列号控制、CRC。

交换机是透明的，没有自己的MAC地址；但是AP不再是一个透明的设备（有自己的MAC地址）
### 高级功能
* **速率自适应 (Rate Adaptation)：** 根据移动性和 SNR 变化，动态改变传输速率（调制技术）。SNR 降低时降低速率以维持低误码率。
* **电源管理 (Power Management)：** 节点告知 AP “我要睡觉了”，AP 缓存该节点的数据。节点在信标帧之前唤醒查看是否有数据等待。

---

## 6.4 蜂窝互联网接入 (Cellular Internet Access)

### 蜂窝网络架构
* **小区 (Cell)：** 覆盖地理区域。
* **基站 (Base Station, BS)：** 类似于 802.11 AP，负责空中接口 (Air-interface)。
* **MSC (Mobile Switching Center)：** 移动交换中心。连接小区到广域网，管理呼叫建立和移动性。

### 第一跳：多址接入技术
* **FDMA/TDMA：** 分割频率和时隙 (如 GSM)。
* **CDMA：** 码分多址 (如 IS-95, CDMA-2000)。

### 标准演进
* **2G (语音)：** GSM (全球最广泛), IS-136, IS-95。
* **2.5G (语音+数据)：** GPRS (GSM 演进), EDGE。
* **3G (语音+数据)：** UMTS (HSDPA/HSUPA), CDMA-2000 (EVDO)。
* **4G (LTE)：** 高速率，基于 IP。
* **5G：**
    * **特点：** 高带宽 (20 Gbps 峰值)、大连接 (100万/km²)、低时延 (1ms)。
    * **关键技术：** 大规模天线阵 (MIMO)、超密集组网、全频谱接入。
    * **挑战：** 数据安全、工业实时通信的高可靠性需求。

---

## 6.5 个人局域网 (PAN) 与 物联网 (IoT)

### IEEE 802.15 (Bluetooth / ZigBee)
* **蓝牙 (Bluetooth)：**
    * **范围：** < 10米，替代线缆（鼠标、耳机）。
    * **网络结构：** Ad hoc，主/从模式 (Master/Slaves)。
    * **演进：** BLE (低功耗), 蓝牙 5.0 (速度、范围、广播能力提升), Mesh 拓扑。
* **ZigBee (802.15.4)：** 低功耗、低速率、用于控制网络。

### 低功耗技术对比 (IoT)
* **Z-Wave, ZigBee, BLE, 802.11ah (HaLow)** 等技术在数据率、电池寿命、传输距离和成本上各有优劣。
* IoT 使得联网设备数量激增（预计 2020 年达到 500 亿）。

### 梅特卡夫定律 (Metcalfe's Law)
* **定义：** 网络的价值与用户数量的平方成正比 ($V = K \times N^2$)。
* **验证：** Facebook 和腾讯的数据验证了该定律在社交网络收益上的适用性。

---

## 总结 (Summary)

1.  **无线链路特性：** 信号衰减、多径传播、干扰、隐藏终端。
2.  **CDMA：** 通过**正交码片序列**实现多用户共享信道，利用内积运算消除干扰。
3.  **IEEE 802.11 (Wi-Fi)：** CSMA/CA 协议，RTS/CTS 避免冲突，帧结构，被动/主动扫描。
4.  **蜂窝网络：** 架构 (BS, MSC)，多址接入 (TDMA/FDMA/CDMA)，从 2G 到 5G 的演进。
5.  **IoT 与 PAN：** 低功耗、短距离通信技术的发展。